<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.spring.mapper.DeptMapper">
	<select id="getDeptByDeptno" resultType="com.spring.dto.Dept">
		SELECT deptno, dname,
		loc FROM DEPT WHERE deptno= #{deptno}
	</select>

	<select id="getDeptNameByDeptno" resultType="string">
		SELECT dname FROM
		DEPT WHERE deptno=#{deptno}
	</select>

	<select id="getDeptMap" resultMap="getDeptResultMap">
		SELECT deptno, dname, loc
		FROM
		DEPT WHERE deptno= #{deptno}
	</select>
	<resultMap type="hashmap" id="getDeptResultMap">
		<result column="deptno" property="deptno2" />
		<result column="dname" property="dname2" />
		<result column="loc" property="loc2" />
	</resultMap>
	<!-- type이 dto일 경우 property는 dto의 변수와 맞춰줘야한다. -->
	<select id="getAllDept" resultMap="getAllDeptResultMap">
		SELECT * FROM DEPT
	</select>
	<resultMap type="com.spring.dto.Dept"
		id="getAllDeptResultMap">
		<result column="deptno" property="deptno" />
		<result column="dname" property="dname" />
		<result column="loc" property="loc" />
	</resultMap>


	<select id="getAllDeptsMap" resultMap="getAllDeptsMapResultMap">
		SELECT deptno,dname,loc
		FROM DEPT
	</select>
	<resultMap type="hashmap" id="getAllDeptsMapResultMap">
		<result column="deptno" property="deptno" />
		<result column="dname" property="dname" />
		<result column="loc" property="loc" />
	</resultMap>

	<insert id="insertDept" parameterType="com.spring.dto.Dept">
		INSERT INTO dept VALUES
		<trim prefix="(" suffix=")">
			#{deptno},#{dname},#{loc}
		</trim>
	</insert>

	<delete id="deleteDept" parameterType="String">
		DELETE FROM DEPT where
		loc=#{loc}
	</delete>
	<update id="updateDept" parameterType="map">
		UPDATE DEPT SET loc=#{loc} WHERE deptno=#{deptno}
		<if test="dname !=null and dname !=''">
			and dname=#{dname}
		</if>
	</update>


	<insert id="insertDepts" parameterType="com.spring.dto.Dept">
			INSERT INTO DEPT VALUES (deptno, dname, loc)
		<foreach collection="list" open="(" close=")" item="deptList">
			#{deptList.deptno},#{deptList.dname},#{deptList.loc}
		</foreach>
	</insert>
</mapper>
